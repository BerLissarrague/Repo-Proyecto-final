if (self.CavalryLogger) { CavalryLogger.start_js(["ccFypF9"]); }

__d("CometPhotoTagBox_photoTagsEdge.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagBox_photoTagsEdge",selections:[{args:null,kind:"FragmentSpread",name:"CometPhotoTagDropdown_photoTagsEdge"}],type:"PhotoTagsEdge",abstractKey:null};e.exports=a}),null);
__d("CometPhotoTagBox_productMatchTag.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagBox_productMatchTag",selections:[{args:null,kind:"FragmentSpread",name:"CometPhotoTagDropdown_productMatchTag"}],type:"ProductTagProductBox",abstractKey:null};e.exports=a}),null);
__d("CometPhotoTagBox_productTag.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagBox_productTag",selections:[{args:null,kind:"FragmentSpread",name:"CometPhotoTagDropdown_productTag"},{alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],storageKey:null}],type:"ProductTag",abstractKey:null};e.exports=a}),null);
__d("CometPhotoTagDropdown_photoTagsEdge.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}];return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagDropdown_photoTagsEdge",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"source",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:"Story",kind:"LinkedField",name:"creation_story",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"serialized_frtp_identifiers",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"debug_info",storageKey:null}],storageKey:null}],type:"Photo",abstractKey:null}],storageKey:null},{alias:null,args:null,concreteType:"PhotoTag",kind:"LinkedField",name:"tag",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"is_text_tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"is_product_tag",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"can_viewer_remove_tag",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"node",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{kind:"InlineFragment",selections:a,type:"User",abstractKey:null},{kind:"InlineFragment",selections:a,type:"Page",abstractKey:null},{kind:"InlineFragment",selections:a,type:"Group",abstractKey:null}],storageKey:null}],type:"PhotoTagsEdge",abstractKey:null}}();e.exports=a}),null);
__d("CometPhotoTagDropdown_productMatchTag.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagDropdown_productMatchTag",selections:[{alias:null,args:null,concreteType:"ProductTagSuggestedProduct",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"formatted_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:140},{kind:"Literal",name:"width",value:140}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:"profile_picture(height:140,width:140)"},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null}],storageKey:null}],type:"ProductTagProductBox",abstractKey:null};e.exports=a}),null);
__d("CometPhotoTagDropdown_productTag.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a={alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null};return{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CometPhotoTagDropdown_productTag",selections:[a,{alias:null,args:null,concreteType:"ProductItem",kind:"LinkedField",name:"product_item",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"can_viewer_tag_product",storageKey:null},a,{alias:null,args:null,kind:"ScalarField",name:"name",storageKey:null},{alias:null,args:null,concreteType:"TextWithEntities",kind:"LinkedField",name:"formatted_price",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"text",storageKey:null}],storageKey:null},{alias:null,args:[{kind:"Literal",name:"height",value:140},{kind:"Literal",name:"width",value:140}],concreteType:"Image",kind:"LinkedField",name:"profile_picture",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"uri",storageKey:null}],storageKey:"profile_picture(height:140,width:140)"},{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:null}],type:"ProductTag",abstractKey:null}}();e.exports=a}),null);
__d("useAddGlobalEventListenerOnEffect",["HiddenSubtreeContext","react"],(function(a,b,c,d,e,f,g){"use strict";e=d("react");var h=e.useContext,i=e.useEffect;function b(b){var d=h(c("HiddenSubtreeContext")).hiddenOrBackgrounded;i(function(){if(!d){a.addEventListener("resize",b);return function(){return a.removeEventListener("resize",b)}}},[b,d])}g["default"]=b}),98);
__d("ProductTagPhotoViewerRemoveProductTagFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("518");c=b("FalcoLoggerInternal").create("product_tag_photo_viewer_remove_product_tag",a);e.exports=c}),null);
__d("CometPhotoTagDropdown.react",["fbt","ix","Actor","CometMediaViewerPhotoActions","CometMediaViewerPhotoDeleteTagsAction","CometMenu.react","CometPhotoProductTagMenuItem.react","CometPhotoTagDropdown_photoTagsEdge.graphql","CometPhotoTagDropdown_productMatchTag.graphql","CometPhotoTagDropdown_productTag.graphql","CometPhotoTagMenuItem.react","CometRelay","CometTooltip.react","CometTrackingNodeProvider.react","ProductTagPhotoViewerRemoveProductTagFalcoEvent","TetraIcon.react","WebSession","emptyFunction","fbicon","gkx","qex","react","requireDeferred"],(function(a,b,c,d,e,f,g,h,i){"use strict";var j,k,l,m=d("react"),n=d("react").useState,o=c("requireDeferred")("CometMediaRemoveTagFalcoEvent").__setRef("CometPhotoTagDropdown.react");function p(a,b,d,e){d===void 0&&(d=null);e===void 0&&(e=null);var f=a.nodeID,g=a.onError;a=a.taggee;f={action_source:"photo_tag_dropdown",photo_id:f,surface:"photo_viewer",tags:[{taggee:a}]};c("CometMediaViewerPhotoDeleteTagsAction")({environment:b,extraData:{serialized_frtp_identifiers:d,story_debug_info:e},input:f,onError:g})}function q(a,c,e,f,g){var h={product_tag_id:f};d("CometMediaViewerPhotoActions").deleteProductTag({environment:g,input:h,onError:a});b("ProductTagPhotoViewerRemoveProductTagFalcoEvent").log(function(){return{creator_id:c||"",entity_id:f,entity_type:"product_item",media_id:e||"",media_type:"photo",platform:"comet",product_id:f,referral_source:"post_viewer",tag_type:"xy_tag"}})}function a(a){var e,f,g,r,s,t=n(!1),u=t[0],v=t[1];t=d("Actor").useActor();var w=t[0],x=d("CometRelay").useRelayEnvironment();t=d("CometRelay").useFragment(j!==void 0?j:j=b("CometPhotoTagDropdown_photoTagsEdge.graphql"),a.photoTagsEdge);var y=d("CometRelay").useFragment(k!==void 0?k:k=b("CometPhotoTagDropdown_productTag.graphql"),a.productTag),z=d("CometRelay").useFragment(l!==void 0?l:l=b("CometPhotoTagDropdown_productMatchTag.graphql"),a.productMatchTag),A=a.nodeID,B=a.onMouseEnter,C=a.onMouseLeave,D=a.tagModeEnabled,E=y==null?void 0:y.product_item;e=t==null?void 0:(e=t.node)==null?void 0:e.name;var F=E==null?void 0:E.name;f=E==null?void 0:(f=E.formatted_price)==null?void 0:f.text;var G=E==null?void 0:E.id,H=t==null?void 0:(g=t.node)==null?void 0:g.id;g=t==null?void 0:(g=t.tag)==null?void 0:g.is_text_tag;var I=(t==null?void 0:(r=t.tag)==null?void 0:r.is_product_tag)||G!=null,J=g===!0&&I===!1?{name:e}:{id:I?G:H},K=t==null?void 0:(r=t.source)==null?void 0:(g=r.creation_story)==null?void 0:g.serialized_frtp_identifiers,L=t==null?void 0:(r=t.source)==null?void 0:(g=r.creation_story)==null?void 0:g.debug_info,M=function(){return v(!1)};r=function(){var a=y==null?void 0:y.id;I&&a!=null&&a!==""?q(M,w,A,a,x):p({nodeID:A,onError:M,taggee:J},x,K,L);var b=d("WebSession").getId();o.onReady(function(a){a.log(function(){return{media_fbid:A,removed_tag_user_id:H,session_id:b}})});v(!0)};g=(g=t==null?void 0:(g=t.node)==null?void 0:g.url)!=null?g:"";var N=function(a){return B(a,u)},O=function(a){return C(a,u)},P=Boolean(c("qex")._("424")),Q=Boolean(c("qex")._("425")),R=Boolean(c("qex")._("426")),S=P||Q||R;E=F!=null&&f!=null&&G!=null?m.jsx(c("CometPhotoProductTagMenuItem.react"),{adID:a.adID,aux:(E==null?void 0:E.can_viewer_tag_product)===!0?m.jsx(c("CometTooltip.react"),{position:"above",tooltip:h._("Eliminar etiqueta de producto"),children:m.jsx(c("TetraIcon.react"),{"aria-label":h._("Eliminar etiqueta de producto"),color:u?"disabled":"primary",disabled:u,icon:d("fbicon")._(i("478232"),16),onPress:u?c("emptyFunction"):r})}):null,bodyText:f,disabled:u,href:(s=E==null?void 0:E.url)!=null?s:"#",postID:A,primaryText:F,productID:G,profilePictureUri:E==null?void 0:(s=E.profile_picture)==null?void 0:s.uri,tagModeEnabled:D,useDarkTags:P,useNoProductPic:Q,useSmallTags:R}):null;return m.jsx(c("CometTrackingNodeProvider.react"),{trackingNode:254,children:m.jsxs("div",{className:"j83agx80",onMouseEnter:N,onMouseLeave:O,children:[e!=null?m.jsx(c("CometMenu.react"),{size:"full",withArrow:!0,children:m.jsx(c("CometPhotoTagMenuItem.react"),{aux:(t==null?void 0:(s=t.tag)==null?void 0:s.can_viewer_remove_tag)===!0?m.jsx(c("TetraIcon.react"),{"aria-label":h._("eliminar etiqueta"),color:u?"disabled":"primary",disabled:u,icon:d("fbicon")._(i("478232"),16),onPress:u?c("emptyFunction"):r}):null,disabled:u,href:g!==""?g:"#",primaryText:e,testid:void 0})}):null,F!=null&&f!=null&&G!=null&&c("gkx")("1069716")?m.jsx("div",{className:"fop5sh7t obtkqiv7 o22cckgh sv5sfqaa j83agx80",children:S?E:m.jsx(c("CometMenu.react"),{size:"full",withArrow:!0,children:E})}):z!=null&&z.products.length>0?m.jsx(c("CometMenu.react"),{header:{title:h._("Productos similares")},size:"full",truncate:!0,withArrow:!0,children:z.products.map(function(b){if(b==null||b.product_item==null||b.product_item.formatted_price==null)return null;var d=b.product_item,e=d.formatted_price.text,f=d.id;d=d.name;return f==null||d==null||e==null?null:m.jsx(c("CometPhotoProductTagMenuItem.react"),{adID:a.adID,bodyText:e,disabled:u,href:(e=b.product_item.url)!=null?e:"#",isProductMatch:!0,postID:A,primaryText:d,productID:f,profilePictureUri:(e=b.product_item.profile_picture)==null?void 0:e.uri,tagModeEnabled:D},f)}).filter(Boolean)}):null]})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("CometPhotoTagBox.react",["fbt","CometContextualLayer.react","CometPhotoTagBox_photoTagsEdge.graphql","CometPhotoTagBox_productMatchTag.graphql","CometPhotoTagBox_productTag.graphql","CometPhotoTagDropdown.react","CometPressable.react","CometProductTagDotHint.react","CometProductTagFunnelIDContext","CometProductTagReferralCodeContext","CometProductTaggingConstants","CometRelay","CommercePdpProductTagClickFalcoEvent","HiddenSubtreeContext","HoveredProductIDContext","ProductTaggingBuyerTypedLogger","XCometCommerceProductItemControllerRouteBuilder","qex","react","setTimeout","stylex","useAddGlobalEventListenerOnEffect","useVisibilityObserver"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j,k,l=d("react");e=d("react");var m=e.useCallback,n=e.useContext,o=e.useEffect,p=e.useRef,q=e.useState,r="product_tag_on_photo_fullscreen_",s="#",t={hideTag:{opacity:"b5wmifdl"},pressable:{borderTopWidth:"rt8b4zig",borderEndWidth:"n8ej3o3l",borderBottomWidth:"agehan2d",borderStartWidth:"sk4xxmp2",paddingTop:"jb3vyjys",paddingEnd:"rz4wbd8a",paddingBottom:"qt6c0cv9",paddingStart:"a8nywdso"},productTagDot:{marginBottom:"obtkqiv7"},tagBox:{borderTop:"c0kuhrxr",borderEnd:"dloffhmg",borderBottom:"lo2jlchb",borderStart:"rey1xuvt"},tagBoxContainer:{pointerEvents:"oqq733wu",position:"pmk7jnqg"}};function u(a,b){var d=q(!1),e=d[0],f=d[1],g=m(function(c){c?(f(!0),a(b)):(f(!1),a(null))},[a,b]),h=c("qex")._("303")===!0,i=c("qex")._("323")||0,j=c("qex")._("304")||0;d=m(function(){g(!1)},[g]);var k=m(function(){if(!h)return;c("setTimeout")(function(){g(!0)},i);c("setTimeout")(function(){g(!1)},i+j)},[i,j,h,g]);d=c("useVisibilityObserver")({onHidden:d,onVisible:k});return[e,d,g]}function a(a){var e,f=d("CometRelay").useFragment(i!==void 0?i:i=b("CometPhotoTagBox_photoTagsEdge.graphql"),a.photoTagsEdge),g=d("CometRelay").useFragment(j!==void 0?j:j=b("CometPhotoTagBox_productTag.graphql"),a.productTag),v=d("CometRelay").useFragment(k!==void 0?k:k=b("CometPhotoTagBox_productMatchTag.graphql"),a.productMatchTag),w=n(c("CometProductTagFunnelIDContext")),x=q(!1),y=x[0];x=x[1];var z=q(!1),A=z[0],B=z[1];z=q();z[0];var C=z[1];z=n(c("HiddenSubtreeContext")).hiddenOrBackgrounded_FIXME;var D=p(null),E=p(null),F=m(function(){E.current!=null&&E.current.reposition({autoflip:!0})},[]);c("useAddGlobalEventListenerOnEffect")(F);o(function(){return C(!0)},[]);F=a.borderSize;var G=a.horizontalPercentage,H=a.isAddingTag,I=a.nodeID,J=a.onPressHandler,K=a.tagBoxSize,L=a.tagModeEnabled,M=a.verticalPercentage;F=g==null?K+2*F:d("CometProductTaggingConstants").TOTAL_DOT_SIZE;var N=w!=null?r+I+s+w:r+I,O=g==null?void 0:(e=g.product_item)==null?void 0:e.id,P,Q,R=n(c("CometProductTagReferralCodeContext"));O!=null&&(e=c("XCometCommerceProductItemControllerRouteBuilder").buildURL({listing_id:O,ref:"photo_fullscreen",referral_code:N}),P=function(){c("CommercePdpProductTagClickFalcoEvent").log(function(){return{ad_id:a.adID,component:"CometPhotoTagBox",funnel_id:w,marketplace_surface:"photo_fullscreen",post_id:I,product_id:O,referral_code:N}});if(R!=null){var b=new(c("ProductTaggingBuyerTypedLogger"))();b.updateData({component:"CometPhotoTagBox",post_id:I,referral_code:R,surface:"page_photos_tab",unresolved_event:"Actn_PDPProductTagClick"}).log()}},Q={linkProps:{url:L?"#":e},onPress:P});e=n(c("HoveredProductIDContext"));P=O!=null&&e.hoveredProductID===O;var S=g==null?void 0:g.product_item;e=u(e.setHoveredProductID,O);var T=e[0],U=e[1],V=e[2];e=T||A||P;T=e||y||L&&!S;return l.jsxs(l.Fragment,{children:[l.jsx("div",{className:c("stylex")(t.tagBoxContainer,g==null&&v==null&&t.hideTag),ref:D,style:{left:"calc("+G+"% - "+F+"px / 2)",top:"calc("+M+"% - "+F+"px / 2)"},children:D.current&&(g!=null||v!=null)?l.jsx(c("CometPressable.react"),babelHelpers["extends"]({"aria-label":h._("Punto de etiqueta"),onHoverChange:x,overlayDisabled:!0,ref:U,xstyle:t.productTagDot},Q,{children:l.jsx("div",{onMouseEnter:function(){V(!0)},onMouseLeave:function(){V(!1)},children:l.jsx(c("CometProductTagDotHint.react"),{borderSize:d("CometProductTaggingConstants").DOT_HINT_BORDER_SIZE,dotSize:d("CometProductTaggingConstants").DOT_HINT_DOT_SIZE,isHighlighted:e,padding:d("CometProductTaggingConstants").DOT_HINT_PADDING})})})):l.jsx(c("CometPressable.react"),{"aria-label":h._("cuadro de etiqueta"),display:"inline",onHoverChange:x,onPress:J,overlayDisabled:!0,xstyle:t.pressable,children:l.jsx("div",{className:c("stylex")(t.tagBox),style:{height:K,width:K}})})}),!z&&T&&D.current&&l.jsx(c("CometContextualLayer.react"),{align:"middle",contextRef:D,imperativeRef:E,position:"below",children:l.jsx(c("CometPhotoTagDropdown.react"),{adID:a.adID,nodeID:I,onMouseEnter:function(a,b){!H&&!b&&B(!0)},onMouseLeave:function(a,b){!H&&!b&&B(!1)},photoTagsEdge:f,productMatchTag:v,productTag:g,tagModeEnabled:L})},"tagDropdown-"+A.toString())]})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);